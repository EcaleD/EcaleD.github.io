<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="An experimental database documentaion CI pipeline that can detect issues caused by product updates.">
<title>Automate testing in the technical documentation workflow</title>

<link rel='canonical' href='http://localhost:1313/categories/test/doc-test-automation/'>

<link rel="stylesheet" href="/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css"><meta property='og:title' content="Automate testing in the technical documentation workflow">
<meta property='og:description' content="An experimental database documentaion CI pipeline that can detect issues caused by product updates.">
<meta property='og:url' content='http://localhost:1313/categories/test/doc-test-automation/'>
<meta property='og:site_name' content='Xiaokai&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Categories' /><meta property='article:tag' content='Test' /><meta property='article:tag' content='Automation' /><meta property='article:published_time' content='2025-08-27T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-08-27T00:00:00&#43;00:00'/><meta property='og:image' content='http://localhost:1313/categories/test/doc-test-automation/header_image_by_gpt.png' />
<meta name="twitter:title" content="Automate testing in the technical documentation workflow">
<meta name="twitter:description" content="An experimental database documentaion CI pipeline that can detect issues caused by product updates."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/categories/test/doc-test-automation/header_image_by_gpt.png' />
    <link rel="shortcut icon" href="/home.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_4233da62202358c1.jpeg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Xiaokai&#39;s Blog</a></h1>
            <h2 class="site-description">Technical Writer</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/EcaleD/EcaleD.github.io'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/xiaokai-dong/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <rect x="4" y="4" width="16" height="16" rx="2" />
  <line x1="8" y1="11" x2="8" y2="16" />
  <line x1="8" y1="8" x2="8" y2="8.01" />
  <line x1="12" y1="16" x2="12" y2="11" />
  <path d="M16 16v-3a2 2 0 0 0 -4 0" />
</svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#background">Background</a></li>
    <li><a href="#what-is-ci">What is CI?</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#prerequisites">Prerequisites</a></li>
    <li><a href="#step-1-set-up-a-vm-for-testing">Step 1: Set up a VM for testing</a></li>
    <li><a href="#step-2-prepare-the-test-script">Step 2: Prepare the test script</a></li>
    <li><a href="#step-3-register-a-gitlab-runner">Step 3: Register a GitLab Runner</a></li>
    <li><a href="#step-4-create-a-gitlab-ciyml-file">Step 4: Create a .gitlab-ci.yml File</a></li>
    <li><a href="#write-the-test-cases">Write the test cases</a></li>
    <li><a href="#wrap-up">Wrap-up</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/categories/test/doc-test-automation/">
                <img src="/categories/test/doc-test-automation/header_image_by_gpt_hu_54789019d4abdef6.png"
                        srcset="/categories/test/doc-test-automation/header_image_by_gpt_hu_54789019d4abdef6.png 800w, /categories/test/doc-test-automation/header_image_by_gpt_hu_669a4b7fcd5ad203.png 1600w"
                        width="800" 
                        height="533" 
                        loading="lazy"
                        alt="Featured image of post Automate testing in the technical documentation workflow" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/doc-workflow/" >
                Doc Workflow
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/categories/test/doc-test-automation/">Automate testing in the technical documentation workflow</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            An experimental database documentaion CI pipeline that can detect issues caused by product updates.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 27, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="automate-testing-in-the-technical-documentation-workflow">Automate testing in the technical documentation workflow
</h1><p>Keeping technical documentation up‑to‑date is a challenging task. It requires a mechanism to detect discrepancies between the product and the documentation. Without a procedural guarantee, existing docs can be overlooked, since documenting new features takes priority.</p>
<p>One advantage of doc-as-code is that it brings documentation closer to the product code, thereby making it more likely to be built and tested automatically.</p>
<h2 id="background">Background
</h2><p>I worked as a technical writer at a database company last year. Occasionally, code updates would break key procedures described in the documentation.</p>
<p>As we just shifted the docs to Gitlab and started adopting a doc-as-code workflow, I experimented with an automation testing pipeline inspired by our development team’s CI (Continuous Integration), which automatically runs database regression tests on a VM whenever an update was pushed to the main branch.</p>
<p>This is not a step-by-step tutorial but more of a project summary, as the process contains steps that only apply to a certain type of database docs. But I think the idea can be generalized and potentially applied to doc workflows facing similar maintenance issues.</p>
<h2 id="what-is-ci">What is CI?
</h2><p>If you’re unfamiliar with <a class="link" href="https://en.wikipedia.org/wiki/Continuous_integration"  target="_blank" rel="noopener"
    >Continuous Integration (CI)</a>, it&rsquo;s a process that allows developers to merge changes into the main codebase frequently. CI includes automated tests that verify the changes and ensure no conflicts arise.</p>
<p>In addition, my project leverages the PostgreSQL regression testing tool, <a class="link" href="https://www.postgresql.org/docs/current/regress.html"  target="_blank" rel="noopener"
    ><code>pg_regress</code></a>, to do the actual testing work. With <code>pg_regress</code> you simply create test cases in SQL; the tool runs them and returns the results and debugging information.</p>
<h2 id="flow">Flow
</h2><p>Here’s how the automation test works:</p>
<p><img src="/categories/test/doc-test-automation/doc-automation-flow.png"
	width="3928"
	height="2516"
	srcset="/categories/test/doc-test-automation/doc-automation-flow_hu_3747baf4cb14fb20.png 480w, /categories/test/doc-test-automation/doc-automation-flow_hu_1064df61f8da2973.png 1024w"
	loading="lazy"
	
		alt="Automation Testing Flow"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="374px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">DB updated → CI pipeline triggered → (In VM) Pull test cases → 
</span></span><span class="line"><span class="cl">Install the latest DB →  Run the tests → 
</span></span><span class="line"><span class="cl">Return test results → Clean up the env
</span></span></code></pre></td></tr></table>
</div>
</div><p>Below is a breakdown of how it was established:</p>
<h2 id="prerequisites">Prerequisites
</h2><p>Setting up a full test framework or pipeline from scratch isn’t realistic. So this trial relies on a few prerequisites:</p>
<ul>
<li>Your development team already has a CI pipeline.</li>
<li>Test cases are not difficult to be created. In my case, the test tool uses SQL syntax, which isn’t too complex for a database tech writer.</li>
<li>You have access and permissions to required resources (e.g., VM creation in the dev/test environment).</li>
</ul>
<h2 id="step-1-set-up-a-vm-for-testing">Step 1: Set up a VM for testing
</h2><p>First, you need an environment to run tests. For my case, the pipeline uses <code>pg_regress</code> to execute SQL scripts on a live database. So I needed a VM where the pipeline could install the latest DB, add test cases, and run the tests.</p>
<p>With the help of a test engineer, I got a script that set up and initializes the regression test flow. (This can be done by a writer too, through reading the code of the test pipeline. But it would take much longer.)</p>
<p>You’ll need to check with your dev team about how they manage test environments and mirror the configuration and the launch method.</p>
<h2 id="step-2-prepare-the-test-script">Step 2: Prepare the test script
</h2><p>Next, you’ll need to create a script to do the actual job. The Gitlab CI will pick up and execute the script when the condition you predefined is met.</p>
<p>My script does the following:</p>
<ol>
<li>
<p>Download test cases from the documentation GitLab repo and move them to the specified folder in the VM.<br>
Example code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  <span class="nv">INPUT_DIR</span><span class="o">=</span><span class="s2">&#34;[source_sql_directory]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">EXPECTED_DIR</span><span class="o">=</span><span class="s2">&#34;[source_expected_output_directory]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">SQL_DIR</span><span class="o">=</span><span class="s2">&#34;[destination_sql_directory]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">EXPECTED_DEST_DIR</span><span class="o">=</span><span class="s2">&#34;[destination_expected_output_directory]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">DEBUG_SCHEDULE</span><span class="o">=</span><span class="s2">&#34;[test_schedule_file]&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Move source .sql files and update debug_schedule</span>
</span></span><span class="line"><span class="cl">  move_and_update_sql<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">src_dir</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">dest_dir</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> file in <span class="s2">&#34;</span><span class="nv">$src_dir</span><span class="s2">&#34;</span>/*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="k">continue</span>  <span class="c1"># Skip if not a file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nv">file_name</span><span class="o">=</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">file_base_name</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">file_name</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&#34;</span>  <span class="c1"># Strip the file extension</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&#34;</span><span class="nv">$dest_dir</span><span class="s2">/</span><span class="nv">$file_name</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        mv <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dest_dir</span><span class="s2">/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;test: </span><span class="nv">$file_base_name</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;</span><span class="nv">$DEBUG_SCHEDULE</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;Moved </span><span class="nv">$file_name</span><span class="s2"> to </span><span class="nv">$dest_dir</span><span class="s2"> and updated debug_schedule.&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Move source expected output files</span>
</span></span><span class="line"><span class="cl">  move_and_update_expected<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">src_dir</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">dest_dir</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> file in <span class="s2">&#34;</span><span class="nv">$src_dir</span><span class="s2">&#34;</span>/*<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">||</span> <span class="k">continue</span>  <span class="c1"># Skip if not a file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nv">file_name</span><span class="o">=</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&#34;</span><span class="nv">$dest_dir</span><span class="s2">/</span><span class="nv">$file_name</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        mv <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$dest_dir</span><span class="s2">/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;Moved </span><span class="nv">$file_name</span><span class="s2"> to </span><span class="nv">$dest_dir</span><span class="s2">.&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  move_and_update_sql <span class="s2">&#34;</span><span class="nv">$INPUT_DIR</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$SQL_DIR</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  move_and_update_expected <span class="s2">&#34;</span><span class="nv">$EXPECTED_DIR</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$EXPECTED_DEST_DIR</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Download and install the latest database version.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  <span class="nv">url</span><span class="o">=</span><span class="s2">&#34;[DB_install_package]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">filename</span><span class="o">=</span><span class="k">$(</span>basename <span class="s2">&#34;</span><span class="nv">$url</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  wget <span class="s2">&#34;</span><span class="nv">$url</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  rpm -ivh <span class="s2">&#34;</span><span class="nv">$filename</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Run the tests and print the results.</p>
</li>
<li>
<p>Clean up the environment.</p>
</li>
</ol>
<h2 id="step-3-register-a-gitlab-runner">Step 3: Register a GitLab Runner
</h2><p>GitLab uses runners to execute CI/CD tasks in a given env defined in the <code>.gitlab-ci.yml</code> file in each repo. You define how the runner is triggered and what it would do in your test env.</p>
<ol>
<li>
<p>Install GitLab Runner on the VM:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  <span class="c1"># Add the GitLab Runner repository</span>
</span></span><span class="line"><span class="cl">  curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh <span class="p">|</span> sudo bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Install GitLab Runner</span>
</span></span><span class="line"><span class="cl">  sudo apt-get update
</span></span><span class="line"><span class="cl">  sudo apt-get install -y gitlab-runner
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Register the Runner:</p>
<ol>
<li>Get a registration token from your GitLab project: <strong>Settings &gt; CI/CD &gt; Runners &gt; Expand &ldquo;Set up a specific Runner manually&rdquo;</strong>.</li>
<li>On the VM, run: <code>sudo gitlab-runner register</code>, then follow the prompts to complete the registration:
<ul>
<li>GitLab instance URL: e.g., <a class="link" href="https://gitlab.com"  target="_blank" rel="noopener"
    >https://gitlab.com</a> or your self-hosted instance</li>
<li>Registration token: from the UI</li>
<li>Description: a name to identify the runner</li>
<li>Tags: optional</li>
<li>Executor: enter <code>shell</code></li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="step-4-create-a-gitlab-ciyml-file">Step 4: Create a .gitlab-ci.yml File
</h2><p>This file defines your CI pipeline. Place it in the root of your documentation repo. You need to put the script you created in Step 2 to the <code>script</code> section in the yml file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">stages</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">centos7:x86_64:icw</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l">test      </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      - echo &#34;Running tests&#34;
</span></span></span><span class="line"><span class="cl"><span class="sd">      # Add the script here      </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">changes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">test_case/**/*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="l">hours</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">allow_failure</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">variables</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">CI_DEBUG_TRACE</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>By now, the pipeline has been built up. The next thing is to create test cases and get the pipeline run when DB is updated!</p>
<h2 id="write-the-test-cases">Write the test cases
</h2><p><code>pg_regress</code> makes it simple to write tests. For each test case, it requires two files:</p>
<ul>
<li>A <code>.sql</code> file that contains the SQL commands to be run</li>
<li>A <code>.out</code> file that contains the expected output</li>
</ul>
<p>To verify the test cases:</p>
<ul>
<li>Check <code>regression.diffs</code> to compare expected vs actual output (watch out for extra spaces at line edges).</li>
<li>Inspect test output in the <code>results</code> folder.</li>
</ul>
<p>After a test case is created, you can just add them to the doc repo, the pipeline will automatically pick them up when triggered.</p>
<h2 id="wrap-up">Wrap-up
</h2><p>By this point, the initial version of the test pipeline is set up. The last thing is to set a proper trigger for the pipeline, for example, when the new DB version is out, the pipeline is triggered and also pulls the URL to the new DB’s installation package.</p>
<p>This pipeline is far from perfect and could be improved in all aspects. It’s just a proof-of-concept of a development-styled test process for docs. When manual maintenance becomes unmanageable, it&rsquo;s worth trying to set up such an automation to help.</p>
<p>Improving points:</p>
<ol>
<li>AI could be leveraged to convert existing tutorials into test cases, which would significantly expand the scope of the test.</li>
<li>Enterprise databases often integrate with broader architectures (e.g., Hadoop or Hive). If the workflow can set up environments for those integration use cases, more complex tutorials could be included in the testing.</li>
</ol>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/test/">Test</a>
        
            <a href="/tags/automation/">Automation</a>
        
    </section>

    <section class="article-share">
    <span>Share:</span>
    <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A1313%2Fcategories%2Ftest%2Fdoc-test-automation%2F&text=Automate&#43;testing&#43;in&#43;the&#43;technical&#43;documentation&#43;workflow" target="_blank" rel="noopener noreferrer" aria-label="Twitter">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



    </a>
    <a href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A1313%2Fcategories%2Ftest%2Fdoc-test-automation%2F" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-facebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" />
</svg>
    </a>
    <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A1313%2Fcategories%2Ftest%2Fdoc-test-automation%2F" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <rect x="4" y="4" width="16" height="16" rx="2" />
  <line x1="8" y1="11" x2="8" y2="16" />
  <line x1="8" y1="8" x2="8" y2="8.01" />
  <line x1="12" y1="16" x2="12" y2="11" />
  <path d="M16 16v-3a2 2 0 0 0 -4 0" />
</svg>
    </a>
</section>

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Xiaokai Dong
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.33592c1d3646904e9e6e474e18ab1199355c4779d67d53fad77663ca90cb5774.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
